# Change: 增强表格编辑器交互能力

## Why

当前文书管理模块的表格编辑器存在以下问题：

1. **WPS 粘贴内容超出单元格**：从 WPS 复制的内容粘贴到编辑器时，内容会超出单元格边界，但在 WPS 中显示正常。这导致文档格式不一致，影响用户体验。

2. **表格交互能力不足**：当前编辑器只支持基础的表格操作（添加/删除整行/整列、调整列宽），缺少类似 WPS 的完整表格编辑功能：
   - 无法在特定单元格上方或下方插入新单元格
   - 无法删除单个单元格（只能删除整行/整列）
   - 无法合并或拆分单元格
   - 缺少右键菜单等便捷操作方式

这些问题限制了用户编辑表格的灵活性，特别是在处理复杂表格结构时。

## What Changes

- **优化 WPS 粘贴处理**：改进 `transformPastedHTML` 逻辑，正确处理表格单元格的宽度和内容溢出，确保粘贴内容不会超出单元格边界
- **增强单元格操作**：支持在选中单元格的上方或下方插入新单元格（而非整行）
- **支持单元格删除**：支持删除单个单元格（自动调整表格结构）
- **实现单元格合并**：支持合并选中的多个单元格（横向、纵向或矩形区域）
- **实现单元格拆分**：支持将合并的单元格拆分为原始结构
- **改进表格工具栏**：在工具栏中添加合并/拆分按钮，并优化现有按钮的可用性判断
- **添加右键菜单**：为表格单元格添加上下文菜单，提供快速访问常用操作

## Impact

- **Affected specs**: 
  - `table-editor` - 新增表格编辑器增强能力规范
- **Affected code**: 
  - `frontend/components/documents/document-editor.tsx` - 优化粘贴处理和添加表格操作按钮
  - `frontend/components/template-editor/document-editor.tsx` - 同步优化（如果使用相同组件）
  - `frontend/components/template-editor/extensions.ts` - 扩展 TableCell 扩展以支持合并/拆分操作
  - `frontend/app/globals.css` - 添加表格单元格溢出控制样式
  - `app/template_editor/mappers.py` - 确保合并单元格在导出时正确处理

