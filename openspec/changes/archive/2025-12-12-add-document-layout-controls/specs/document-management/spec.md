## ADDED Requirements

### Requirement: 页面边距调整功能
系统 SHALL 在文书编辑器中提供页面边距调整功能，允许用户通过下拉菜单选择预设的边距值。

#### Scenario: 显示页面边距控制按钮
- **WHEN** 用户在编辑模式下查看文书编辑器工具栏
- **THEN** 系统 SHALL 在格式工具栏中显示"页边距"按钮
- **AND** 按钮 SHALL 显示当前边距设置的图标和名称
- **AND** 点击按钮 SHALL 显示包含预设选项的下拉菜单

#### Scenario: 选择预设页面边距
- **WHEN** 用户点击"页边距"按钮并选择一个预设选项
- **THEN** 系统 SHALL 立即应用新的页面边距设置到文档
- **AND** 系统 SHALL 更新文档预览以反映新的边距
- **AND** 系统 SHALL 保存边距设置到文档模板元数据
- **AND** 预设选项 SHALL 包括：窄边距(12.7mm)、适中边距(19.05mm)、正常边距(25.4mm)、宽边距(38.1mm)

#### Scenario: 页面边距实时预览
- **WHEN** 用户选择不同的页面边距预设
- **THEN** 系统 SHALL 实时更新文档布局显示
- **AND** 系统 SHALL 重新计算分页以适应新的内容区域
- **AND** 系统 SHALL 保持文档内容的完整性

### Requirement: 行间距调整功能
系统 SHALL 在文书编辑器中提供行间距调整功能，允许用户通过下拉菜单选择预设的行间距值。

#### Scenario: 显示行间距控制按钮
- **WHEN** 用户在编辑模式下查看文书编辑器工具栏
- **THEN** 系统 SHALL 在格式工具栏中显示"行间距"按钮
- **AND** 按钮 SHALL 显示当前行间距设置的图标和数值
- **AND** 点击按钮 SHALL 显示包含预设选项的下拉菜单

#### Scenario: 选择预设行间距
- **WHEN** 用户点击"行间距"按钮并选择一个预设选项
- **THEN** 系统 SHALL 立即应用新的行间距设置到选中的文本段落
- **AND** 如果没有选中特定文本，则应用于整个文档
- **AND** 系统 SHALL 保存行间距设置到文档模板元数据
- **AND** 预设选项 SHALL 包括：1.0(单倍行距)、1.15、1.5(默认)、1.75、2.0(双倍行距)

#### Scenario: 行间距应用范围
- **WHEN** 用户选中部分文本并调整行间距
- **THEN** 系统 SHALL 只对选中的段落应用新的行间距
- **AND** 当用户没有选中任何文本时，系统 SHALL 将新的行间距应用于整个文档
- **AND** 系统 SHALL 保持其他段落格式不变

## MODIFIED Requirements

### Requirement: 编辑文书功能
系统 SHALL 提供编辑已存在文书的功能。

#### Scenario: 进入编辑模式
- **WHEN** 用户在预览模式下点击"编辑"按钮
- **THEN** 系统 SHALL 进入富文本编辑模式
- **AND** 系统 SHALL 显示基于 Tiptap 的富文本编辑器
- **AND** 系统 SHALL 加载当前文书的完整内容到编辑器
- **AND** 系统 SHALL 显示"保存"和"取消"按钮
- **AND** 系统 SHALL 不显示"导出 PDF"按钮
- **AND** 系统 SHALL 在工具栏中显示页面边距和行间距控制按钮
- **AND** 系统 SHALL 加载并显示当前文档的页面布局设置

#### Scenario: 保存编辑
- **WHEN** 用户在编辑模式下修改内容、调整布局并点击"保存"
- **THEN** 系统 SHALL 弹出命名对话框
- **AND** 系统 SHALL 在对话框中显示当前文书名称（如果存在）
- **AND** 系统 SHALL 允许用户输入或修改文书名称
- **AND** 系统 SHALL 在用户确认后保存修改后的内容、布局设置和名称
- **AND** 系统 SHALL 返回预览模式显示更新后的文书
- **AND** 系统 SHALL 更新文书的更新时间
- **AND** 系统 SHALL 在预览模式中应用保存的页面布局设置

### Requirement: 新增文书功能
系统 SHALL 提供新增文书功能，支持使用富文本编辑器创建新文书。

#### Scenario: 进入新增文书模式
- **WHEN** 用户点击"新增文书"按钮
- **THEN** 系统 SHALL 进入富文本编辑模式
- **AND** 系统 SHALL 显示基于 Tiptap 的富文本编辑器
- **AND** 系统 SHALL 提供空白的编辑区域
- **AND** 系统 SHALL 显示"保存"和"取消"按钮
- **AND** 系统 SHALL 不显示"导出 PDF"按钮
- **AND** 系统 SHALL 在工具栏中显示页面边距和行间距控制按钮
- **AND** 系统 SHALL 将页面布局设置为默认值（正常边距、1.5行间距）

### Requirement: 文书预览功能
系统 SHALL 提供文书预览功能，显示文书的完整内容。

#### Scenario: 预览文书
- **WHEN** 用户点击列表中的某个文书
- **THEN** 系统 SHALL 在预览区域显示该文书的完整内容
- **AND** 系统 SHALL 保持原始文档的格式样式（字体、段落、表格等）
- **AND** 系统 SHALL 应用保存的页面边距和行间距设置
- **AND** 系统 SHALL 提供"编辑"按钮
- **AND** 系统 SHALL 如果文书状态为"发布"，则提供"生成"按钮
- **AND** 系统 SHALL 如果文书状态为"草稿"，则提供"导出 PDF"按钮
- **AND** 系统 SHALL 如果文书状态为"发布"，则提供"导出 PDF"按钮（在预览模式下）

### Requirement: PDF 导出功能
系统 SHALL 提供将文书导出为 PDF 的功能，确保导出内容与预览内容格式一致。

#### Scenario: 导出文书为 PDF
- **WHEN** 用户在预览模式下点击"导出 PDF"按钮
- **THEN** 系统 SHALL 将当前文书内容转换为 HTML
- **AND** 系统 SHALL 在 HTML 中包含保存的页面边距和行间距样式
- **AND** 系统 SHALL 将 HTML 发送到后端进行 PDF 生成
- **AND** 系统 SHALL 下载生成的 PDF 文件
- **AND** 系统 SHALL 确保 PDF 内容与预览内容完全一致，包括页面布局设置