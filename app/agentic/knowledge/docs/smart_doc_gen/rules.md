# 法律文书生成与填充核心规则 (Core Rules for Legal Document Generation)

## 一、数据理解与分类 (Data Understanding)

### 1.1 当事人类型定义 (Party Types)
案件当事人（原告/被告/第三人）主要分为以下三类，不同类型决定了必须填充的模板区块：

*   **自然人 (Natural Person)**
    *   **关键词**: "公民", "自然人", "个人".
    *   **特征**: 拥有 "姓名", "身份证号" (ID Card), "住址".
    *   **适用区块**: 仅填充模板中标记为 `(自然人)`、`(公民)` 的区块。

*   **法人组织 (Legal Entity / Company)**
    *   **关键词**: "公司", "企业", "法人".
    *   **特征**: 拥有 "公司名称", "统一社会信用代码", "住所地", "法定代表人".
    *   **适用区块**: 仅填充模板中标记为 `(法人)`、`(公司)` 的区块。

*   **非法人组织 (Unincorporated Organization)**
    *   **关键词**: "个体工商户", "个人独资企业", "合伙企业".
    *   **特征**: 视为**特殊机构**。拥有 "字号名称" (如某某商行), "经营者" (Owner).
    *   **重要规则**: 个体工商户在法律上虽由自然人经营，但在文书格式上通常归类为 **"组织"** 或 **"非法人组织"**。
    *   **适用区块**: 优先填充 `(非法人组织)` 或 `(单位)` 区块；若无专用区块，可借用 `(公司)` 区块，将经营者填入 "法定代表人/主要负责人" 栏。
    *   **互斥锁**: 既然归类为组织，其对应的 **"(自然人)" 区块必须跳过，不要在输出中包含其 ID**，保持模板原样。

---

## 二、模板理解与结构 (Template Understanding)

### 2.1 模板类型
*   **要素式 (Element-based)**: 全文主要由表格构成，字段清晰（如 "表格式起诉状"）。策略：精准键值对映射。
*   **陈述式 (Narrative)**: 全文主要由段落文字构成，留空处为待填内容（如 "传统起诉状"）。策略：需结合上下文语义填充。

### 2.2 超集模板排他性原则 (Superset Template Exclusivity)
许多模板是 **"全能型 (Superset)"** 的，即同时包含了自然人和法人的填空项。
*   **互斥规则 (Mutually Exclusive)**: 对于同一个当事人，**只能** 填充其对应类型的一个区块。
*   **操作指令**: 
    1.  判断当事人类型（如：被告是公司）。
    2.  **必须跳过** 所有不属于该类型的区块，**绝对不要**在最终的 JSON `fillings` 中生成这些区块的 ID。
    3.  **严禁使用** 任何占位符（如 `N/A`, `Unknown` 等）。
    4.  **只填充** 属于该类型的区块。

---

## 三、映射与填充逻辑 (Mapping & Filling Logic)

### 3.1 数据可用性原则 (Data Availability)
*   **确切已知 (Exact Match)**: 只填充你根据证据和案情 **100% 确定** 的信息。
*   **宁缺毋滥**: 如果没有找到对应信息（如 "民族"、"电话号码"），**保持空白**，绝对不要编造或填 "无"、"未知"。

### 3.2 权威信源优先 (Authoritative Source First)
当数据源冲突时，优先级如下：
1.  **证据卡片 (Evidence Cards)**: OCR 识别的证件信息（营业执照、身份证）是最高真理。
2.  **案件结构化数据 (Case Data)**: 用户录入的信息。
3.  **推断信息**: 基于语义的合理推断（如根据身份证号推算生日）。

### 3.3 格式与不可变原则 (Formatting & Immutable)
*   **智能追加**: 如果模板字段自带前缀（如 "原告：____"），只填内容（"张三"），不要重复前缀。
*   **勾选框**: 将选中的选项映射为 `☑`，未选中的选项保持 `□`。
*   **严禁修改**: 绝对不允许删除模板中原有的其他文字，只处理待填空的 `id`。

---

## 四、完整性原则 (Completeness)
*   **遍历所有区块**: 不要只关注当事人信息。必须检查模板中的每一个表格行（诉讼请求、事实与理由、证据清单、签署日期等）和每一个段落。
*   **事实与理由**: 必须根据案情详细填写“事实与理由”部分，包括但不限于：合同签订情况、履行情况、违约事实、欠款金额计算方式等。
*   **宁缺毋滥 (再次强调)**: 但对于确实不知道的信息（如对方未提供的银行账号），依然保持跳过。
